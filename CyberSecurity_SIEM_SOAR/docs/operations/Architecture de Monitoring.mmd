flowchart TB
    subgraph "Monitoring Infrastructure"
        PROMETHEUS[Prometheus<br/>Collecte métriques]
        GRAFANA[Grafana<br/>Visualisation]
        ALERTMANAGER[AlertManager<br/>Gestion alertes]
    end
    
    subgraph "SIEM/SOAR Stack"
        WAZUH[Wazuh Manager<br/>:9200]
        THEHIVE[TheHive<br/>:9000]
        CORTEX[Cortex<br/>:9001]
        MISP[MISP<br/>:80/443]
        SURICATA[Suricata<br/>IDS/IPS]
    end
    
    subgraph "Infrastructure"
        PFSENSE[pfSense<br/>Firewall]
        OSQUERY[OSQuery<br/>Endpoints]
        SYSLOG[Syslog Server<br/>:514]
    end
    
    WAZUH -->|Métriques :9095| PROMETHEUS
    THEHIVE -->|Métriques :9095| PROMETHEUS
    CORTEX -->|Métriques :9096| PROMETHEUS
    MISP -->|Health Check| PROMETHEUS
    SURICATA -->|Stats via Wazuh| PROMETHEUS
    PFSENSE -->|SNMP :161| PROMETHEUS
    OSQUERY -->|Logs via Wazuh| PROMETHEUS
    
    PROMETHEUS --> GRAFANA
    PROMETHEUS --> ALERTMANAGER
    ALERTMANAGER -->|Notifications| SLACK[Slack SOC]
    ALERTMANAGER -->|Email| SOC_TEAM[Équipe SOC]
    
    classDef monitoring fill:#e8f5e8,stroke:#4caf50,stroke-width:2px,color:#1b5e20
    classDef siem fill:#e1f5fe,stroke:#0277bd,stroke-width:2px,color:#01579b
    classDef infra fill:#fff3e0,stroke:#f57c00,stroke-width:2px,color:#e65100
    classDef alert fill:#ffebee,stroke:#f44336,stroke-width:2px,color:#c62828

    class PROMETHEUS,GRAFANA,ALERTMANAGER monitoring
    class WAZUH,THEHIVE,CORTEX,MISP,SURICATA siem
    class PFSENSE,OSQUERY,SYSLOG infra
    class SLACK,SOC_TEAM alert