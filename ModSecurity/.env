# =================================================================
# Configuration SOAR ModSecurity Lab - Med10S
# Date: 2025-08-09 00:33:04 UTC
# =================================================================

# Project Configuration
PROJECT_NAME=modsecurity-soar
ENVIRONMENT=production
ANALYST_NAME=Med10S
LOG_LEVEL=INFO

# Network Configuration
NETWORK_SUBNET=172.20.0.0/16
HTTP_PORT=8011
HTTPS_PORT=543
WEBAPP_PORT=8180

# Container Names
MODSECURITY_CONTAINER_NAME=modsecurity-waf-${ANALYST_NAME}
WEBAPP_CONTAINER_NAME=dvwa-app-${ANALYST_NAME}
DB_CONTAINER_NAME=mysql-dvwa-${ANALYST_NAME}
WAZUH_AGENT_CONTAINER_NAME=wazuh-agent-modsec-${ANALYST_NAME}
LOG_PROCESSOR_CONTAINER_NAME=log-processor-${ANALYST_NAME}
MONITORING_CONTAINER_NAME=soar-monitoring-${ANALYST_NAME}

# Docker Images
MODSECURITY_IMAGE=owasp/modsecurity:3.0.12-apache
WEBAPP_IMAGE=vulnerables/web-dvwa:latest
DB_IMAGE=mysql:8.0
WAZUH_AGENT_IMAGE=wazuh/wazuh-agent:4.7.2
MONITORING_IMAGE=alpine:3.18

# Restart Policy
RESTART_POLICY=unless-stopped

# ModSecurity Configuration
MODSEC_RULE_ENGINE=On
MODSEC_REQ_BODY_ACCESS=On
MODSEC_REQ_BODY_LIMIT=13107200
MODSEC_REQ_BODY_NOFILES_LIMIT=131072
MODSEC_RESP_BODY_ACCESS=On
MODSEC_RESP_BODY_LIMIT=524288
MODSEC_AUDIT_ENGINE=On
MODSEC_AUDIT_LOG_PARTS=ABCDEFGHIJKZ
SERVER_NAME=modsecurity-soar.local

# DVWA Configuration
WEBAPP_SERVICE_NAME=webapp
WEBAPP_INTERNAL_PORT=80
DVWA_DIFFICULTY=low
DVWA_RECAPTCHA_PUBLIC_KEY=
DVWA_RECAPTCHA_PRIVATE_KEY=

# Database Configuration
DB_HOST=mysql-db
DB_NAME=dvwa
DB_USER=dvwa
DB_PASSWORD=SecureP@ssw0rd2025!
DB_ROOT_PASSWORD=RootP@ssw0rd2025!
DB_CHARSET=utf8mb4
DB_COLLATION=utf8mb4_unicode_ci

# Wazuh Configuration
WAZUH_MANAGER_IP=192.168.1.100
WAZUH_MANAGER_PORT=1514
WAZUH_PROTOCOL=tcp
WAZUH_REGISTRATION_SERVER=192.168.1.100
WAZUH_REGISTRATION_PORT=1515
WAZUH_REGISTRATION_PASSWORD=
WAZUH_AGENT_GROUP=modsecurity
WAZUH_AGENT_NAME=modsecurity-waf-med10s
WAZUH_KEEP_ALIVE_INTERVAL=60
WAZUH_TIME_RECONNECT=60
WAZUH_AUTO_RESTART=yes
WAZUH_MANAGER_API=http://192.168.1.100:55000
WAZUH_API_USER=wazuh
WAZUH_API_PASSWORD=wazuh123

# n8n Configuration
N8N_HOST=192.168.1.101
N8N_PORT=5678
N8N_WEBHOOK_URL=http://192.168.1.101:5678/webhook/modsecurity-xss
N8N_API_URL=http://192.168.1.101:5678/rest
N8N_API_KEY=your-n8n-api-key-here

# TheHive Configuration
THEHIVE_HOST=192.168.1.102
THEHIVE_PORT=9000
THEHIVE_URL=http://192.168.1.102:9000
THEHIVE_API_KEY=your-thehive-api-key-here
THEHIVE_ORGANIZATION=SOAR-Lab-Med10S

# Cortex Configuration
CORTEX_HOST=192.168.1.103
CORTEX_PORT=9001
CORTEX_URL=http://192.168.1.103:9001
CORTEX_API_KEY=your-cortex-api-key-here

# MISP Configuration
MISP_HOST=192.168.1.104
MISP_PORT=443
MISP_URL=https://192.168.1.104:443
MISP_API_KEY=your-misp-api-key-here
MISP_VERIFY_TLS=false

# SSL Configuration
SSL_CERTIFICATE_PATH=./ssl/server.crt
SSL_PRIVATE_KEY_PATH=./ssl/server.key
SSL_DHPARAM_PATH=./ssl/dhparam.pem
SSL_GENERATE_SELF_SIGNED=true
SSL_COUNTRY=FR
SSL_STATE=Region
SSL_CITY=City
SSL_ORGANIZATION=SOAR-Lab-Med10S
SSL_ORGANIZATIONAL_UNIT=Security

# Logging Configuration
LOG_ROTATION_SIZE=100M
LOG_RETENTION_DAYS=30
LOG_MAX_FILES=10

# Alerting Configuration
ALERT_EMAIL=med10s@soar-lab.com
ALERT_THROTTLE_MINUTES=5
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK
TELEGRAM_BOT_TOKEN=
TELEGRAM_CHAT_ID=

# Email Configuration (SMTP)
SMTP_SERVER=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=med10s@soar-lab.com
SMTP_PASSWORD=your-smtp-password-here
SMTP_FROM=SOAR-Lab-Alerts <noreply@soar-lab.com>

# Monitoring Configuration
MONITORING_INTERVAL=60
HEALTH_CHECK_INTERVAL=30
PERFORMANCE_MONITORING=true
METRICS_COLLECTION=true

# Performance Tuning
MAX_CONNECTIONS=1000
WORKER_PROCESSES=auto
WORKER_CONNECTIONS=1024
KEEPALIVE_TIMEOUT=65
CLIENT_MAX_BODY_SIZE=10m

# Security Configuration
FAIL2BAN_ENABLED=true
FAIL2BAN_MAX_RETRY=5
FAIL2BAN_BAN_TIME=3600
RATE_LIMITING_ENABLED=true
RATE_LIMIT_RPS=10

# Development/Testing
DEBUG_MODE=false
VERBOSE_LOGGING=false
TEST_MODE=false
MOCK_EXTERNAL_APIS=false

# Backup Configuration
BACKUP_ENABLED=true
BACKUP_INTERVAL=daily
BACKUP_RETENTION_DAYS=7
BACKUP_LOCATION=./backup