# =================================================================
# Configuration SOAR ModSecurity Lab - Med10S
# Date: 2025-08-09 00:33:04 UTC
# =================================================================

# Project Configuration
PROJECT_NAME=modsecurity-soar
ENVIRONMENT=production
ANALYST_NAME=Med10S
LOG_LEVEL=INFO

# Network Configuration
NETWORK_SUBNET=172.20.0.0/16
HTTP_PORT=80
HTTPS_PORT=443
WEBAPP_PORT=8180

# Container Names
MODSECURITY_CONTAINER_NAME=modsecurity-waf-Med10S
WEBAPP_CONTAINER_NAME=dvwa-app-Med10S
DB_CONTAINER_NAME=mysql-dvwa-Med10S
WAZUH_AGENT_CONTAINER_NAME=wazuh-agent-modsec-Med10S
LOG_PROCESSOR_CONTAINER_NAME=log-processor-Med10S
MONITORING_CONTAINER_NAME=soar-monitoring-Med10S

# Docker Images
MODSECURITY_IMAGE=owasp/modsecurity:3.0.8-alpine-202210230310
WEBAPP_IMAGE=vulnerables/web-dvwa:latest
DB_IMAGE=mysql:8.0
WAZUH_AGENT_IMAGE=wazuh/wazuh-agent:4.13.0-rc3
MONITORING_IMAGE=alpine:3.18

# Restart Policy
RESTART_POLICY=unless-stopped

# ModSecurity Configuration
MODSEC_RULE_ENGINE=On
MODSEC_REQ_BODY_ACCESS=On
MODSEC_REQ_BODY_LIMIT=13107200
MODSEC_REQ_BODY_NOFILES_LIMIT=131072
MODSEC_RESP_BODY_ACCESS=On
MODSEC_RESP_BODY_LIMIT=524288
MODSEC_AUDIT_ENGINE=On
MODSEC_AUDIT_LOG_PARTS=ABCDEFGHIJKZ
SERVER_NAME=modsecurity-soar.local

# DVWA Configuration
WEBAPP_SERVICE_NAME=webapp
WEBAPP_INTERNAL_PORT=80
DVWA_DIFFICULTY=low
DVWA_RECAPTCHA_PUBLIC_KEY=
DVWA_RECAPTCHA_PRIVATE_KEY=

# Database Configuration
DB_HOST=mysql-db
DB_NAME=dvwa
DB_USER=dvwa
DB_PASSWORD=SecureP@ssw0rd2025!
DB_ROOT_PASSWORD=RootP@ssw0rd2025!
DB_CHARSET=utf8mb4
DB_COLLATION=utf8mb4_unicode_ci

# Wazuh Configuration
WAZUH_MANAGER_IP=192.168.1.3
WAZUH_MANAGER_PORT=1514
WAZUH_PROTOCOL=tcp
WAZUH_REGISTRATION_SERVER=192.168.1.3
WAZUH_REGISTRATION_PORT=1515
WAZUH_AGENT_GROUP=general
WAZUH_AGENT_NAME=modsecurity-waf
WAZUH_KEEP_ALIVE_INTERVAL=60
WAZUH_TIME_RECONNECT=60
WAZUH_AUTO_RESTART=yes
WAZUH_MANAGER_API=http://192.168.1.3:55000
WAZUH_API_USER=wazuh-wui
WAZUH_API_PASSWORD=MyS3cr37P450r.*-

# n8n Configuration
N8N_HOST=192.168.1.3
N8N_PORT=5678
N8N_WEBHOOK_URL=http://192.168.1.3:5678/webhook/modsecurity-xss

# TheHive Configuration
THEHIVE_HOST=192.168.1.3
THEHIVE_PORT=9999
THEHIVE_URL=http://192.168.1.3:9999
THEHIVE_API_KEY=m1sWpiTL6I8lz4+8Iy+ms7t8sa1SvQLJ      

# Cortex Configuration
CORTEX_HOST=192.168.1.3
CORTEX_PORT=9001
CORTEX_URL=http://192.168.1.3:9001
CORTEX_API_KEY=tz8nVypUQKjyC3/PVCcnVo/DFqgewInq

# MISP Configuration
MISP_HOST=192.168.1.3
MISP_PORT=4432
MISP_URL=https://192.168.1.3:4432
MISP_API_KEY=qvAXcAu5pjigWiSMZ0k6xRNeauBMAu5DIe521cQQ
MISP_VERIFY_TLS=false

# SSL Configuration
SSL_CERTIFICATE_PATH=./ssl/server.crt
SSL_PRIVATE_KEY_PATH=./ssl/server.key
SSL_DHPARAM_PATH=./ssl/dhparam.pem
SSL_GENERATE_SELF_SIGNED=true
SSL_COUNTRY=FR
SSL_STATE=Region
SSL_CITY=City
SSL_ORGANIZATION=SOAR-Lab-Med10S
SSL_ORGANIZATIONAL_UNIT=Security

# Logging Configuration
LOG_ROTATION_SIZE=100M
LOG_RETENTION_DAYS=30
LOG_MAX_FILES=10

# Alerting Configuration
ALERT_EMAIL=admin@sbihi.soar.ma
ALERT_THROTTLE_MINUTES=5
TELEGRAM_BOT_TOKEN=8449461833:AAFiqeCMRFH3ZLWq77KFk-Dy56H0lpnYzg0
TELEGRAM_CHAT_ID=SOC_Team

# Email Configuration (SMTP)
SMTP_SERVER=sbihi.soar.ma
SMTP_PORT=143
SMTP_USER=admin@sbihi.soar.ma
SMTP_PASSWORD=mohammed
SMTP_FROM=admin@sbihi.soar.ma

# Monitoring Configuration
MONITORING_INTERVAL=60
HEALTH_CHECK_INTERVAL=30
PERFORMANCE_MONITORING=true
METRICS_COLLECTION=true

# Performance Tuning
MAX_CONNECTIONS=1000
WORKER_PROCESSES=auto
WORKER_CONNECTIONS=1024
KEEPALIVE_TIMEOUT=65
CLIENT_MAX_BODY_SIZE=10m

# Security Configuration
FAIL2BAN_ENABLED=true
FAIL2BAN_MAX_RETRY=5
FAIL2BAN_BAN_TIME=3600
RATE_LIMITING_ENABLED=true
RATE_LIMIT_RPS=10

# Development/Testing
DEBUG_MODE=false
VERBOSE_LOGGING=false
TEST_MODE=false
MOCK_EXTERNAL_APIS=false

# Backup Configuration
BACKUP_ENABLED=true
BACKUP_INTERVAL=daily
BACKUP_RETENTION_DAYS=7
BACKUP_LOCATION=./backup